{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "RulesConfig",
  "type": "object",
  "required": ["title", "version", "guardrails", "ambiguity_thresholds"],
  "properties": {
    "title": { "type": "string" },
    "version": { "type": "string" },
    "description": { "type": "string" },
    "guardrails": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["id", "name", "description", "enforcement", "applies_to"],
        "properties": {
          "id": { "type": "string", "pattern": "^RULE-[0-9]{3}$" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "enforcement": { "type": "string", "enum": ["blocking", "warning"] },
          "applies_to": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["frontend", "backend", "database", "all"]
            }
          },
          "validation": { "type": "string" },
          "examples": {},
          "exclusions": { "type": "array", "items": { "type": "string" } },
          "flagged_libraries": { "type": "array", "items": { "type": "string" } }
        }
      }
    },
    "ambiguity_thresholds": {
      "type": "object",
      "required": ["confidence_floor", "action_below_floor"],
      "properties": {
        "confidence_floor": { "type": "number", "minimum": 0, "maximum": 1 },
        "action_below_floor": { "type": "string", "enum": ["flag_and_halt", "warn_and_continue"] },
        "confidence_scoring_factors": { "type": "array", "items": { "type": "string" } }
      }
    },
    "out_of_scope_behavior": { "type": "string", "enum": ["reject_and_log", "warn_and_skip"] },
    "partial_conversion_handling": { "type": "string", "enum": ["checkpoint_and_resume", "restart_on_failure"] },
    "approval_gate": {
      "type": "object",
      "properties": {
        "required": { "type": "boolean" },
        "timeout_hours": { "type": "integer" },
        "approvers": { "type": "array", "items": { "type": "string" } },
        "implementation": { "type": "string", "enum": ["cli_prompt", "pr_merge", "web_dashboard"] }
      }
    }
  }
}
